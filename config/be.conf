# StarRocks BE配置文件
# Backend节点配置

# 存储配置
storage_root_path = /opt/starrocks/be/storage
default_dirs = /opt/starrocks/be/storage

# 网络配置
priority_networks = 172.20.0.0/16
be_host = starrocks-be
be_port = 9060
webserver_port = 8040
heartbeat_service_port = 9050
brpc_port = 8060

# 内存配置
mem_limit = 80%
chunk_reserved_bytes_limit = 20%
load_data_reserve_memory_mb = 1024
buffer_pool_limit = 20%

# CPU配置
num_threads_per_core = 3
max_consumer_num_per_group = 3
scan_thread_nice_value = 19

# 存储配置
default_num_rows_per_column_file_write = 1024000
pending_data_expire_time_sec = 1800
inc_rowset_expired_sec = 1800
tablet_rowset_stale_sweep_time_sec = 1800
max_tablet_num_per_shard = 1024

# 压缩配置
compress_rowbatches = true
storage_compression_codec = LZ4_FRAME

# 导入配置
streaming_load_max_batch_size_mb = 100
streaming_load_rpc_max_alive_time_sec = 1200
streaming_load_max_mb = 10240
load_data_reserve_memory_mb = 1024

# 查询配置
scanner_thread_pool_thread_num = 48
scanner_thread_pool_queue_size = 102400
scanner_row_num = 16384
max_scan_key_num = 1024
max_pushdown_conditions_per_column = 1024

# 日志配置
LOG_DIR = /opt/starrocks/be/log
LOG_LEVEL = INFO
LOG_ROLL_SIZE_MB = 1024
LOG_DELETE_AGE = 7d

# Cache配置
disable_storage_page_cache = false
storage_page_cache_limit = 20%
datacache_enable = false

# 并发配置
pipeline_exec_thread_pool_thread_num = 0
transaction_publish_version_worker_count = 0
clear_transaction_task_worker_count = 1
clone_worker_count = 3
storage_medium_migrate_count = 1
check_consistency_worker_count = 1
upload_worker_count = 1
download_worker_count = 1
make_snapshot_worker_count = 5
release_snapshot_worker_count = 5
restore_worker_count = 3

# 网络配置
max_client_cache_size_per_host = 10
max_connection_per_be = 9
rpc_retry_times = 3
rpc_timeout_ms = 5000

# 监控配置
report_task_interval_seconds = 10
report_disk_state_interval_seconds = 60
report_tablet_interval_seconds = 60
report_workgroup_interval_seconds = 5

# 副本配置
alter_tablet_worker_count = 3
recovery_low_priority_thread_num = 1
recovery_high_priority_thread_num = 1

# 系统配置
sys_log_dir = /opt/starrocks/be/log
sys_log_level = INFO
sys_log_roll_mode = SIZE-MB-1024
sys_log_roll_num = 10

# 性能配置
disable_mem_pools = false
chunk_reserved_bytes_limit = 20%